<!DOCTYPE html>
<html class="text-success" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>backendServer</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- default bootstrap items -->
    <!-- <script src="assets/bootstrap/js/bootstrap.min.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"> -->
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/Navbar-Centered-Brand-Dark.css">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/createLessonsDefaults.css">
    <!-- code mirror stuff -->
    <script src="codeMirror/lib/codemirror.js"></script>
    <script src="codeMirror/javascript.js"></script>
    <script src="codeMirror/closebrackets.js"></script>
    <script src="codeMirror/matchbrackets.js"></script>
    <link rel="stylesheet" href="codeMirror/lib/codemirror.css">
    <link rel="stylesheet" href="css/myCodeEditorTheme.css">
</head>
<style>
.CodeMirror {
border-radius: 10px;
border-top-left-radius: 0px;
}
.activeTab {
    background-color: rgb(170, 167, 181);
}
</style>
<body>
    <nav id ="navBar" class="navbar navbar-dark navbar-expand-md" style="background: rgb(61, 61, 61);color: rgb(224,224,224);padding: 15px;">
        <div class="container-fluid"><a class="navbar-brand" href="#" style="color: rgba(255,255,255,0.9);font-size: 30px;">JS Lessons</a>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link active" href="#" style="color: rgb(97,161,255);">Create a Lesson</a></li>
                    <li class="nav-item"></li>
                    <li class="nav-item"></li>
                </ul>
            </div><input class="form-control-sm" type="search" style="margin-left: 0px; margin-top: 1px; border-radius: 10px; border-style: none;" placeholder="Search ie : 305502808432711">
            <button class="btn btn-primary btn-sm" type="button" style="margin-left: 10px;border-radius: 10px;height: 31px;">Search</button>
            <button data-bs-target="#navcol-1" data-bs-toggle="collapse" class="navbar-toggler"><span class="visually-hidden">Toggle navigation</span><span class="navbar-dark navbar-toggler-icon"></span></button>
        </div>
    </nav>

    <div class="d-lg-flex flex-row flex-grow-1 flex-shrink-1 justify-content-lg-start" style="padding: 20px;border-style: none;">
        <div class="container d-lg-flex" style="padding-top: 7px;">
            <div class="row flex-fill">
                <div class="col-md-6">
                    <form class="flex-fill">
                        <input class="form-control form-control-sm" type="text" style="border-style: none;border-radius: 8px;" placeholder="Lesson Title">
                        <input class="form-control form-control-sm" type="text" style="border-style: none;border-radius: 8px;" placeholder="Your Question Here">
                        <textarea class="form-control form-control-sm" style="border-radius: 8px;border-style: none;height: 200px;transform: skew(0deg);" spellcheck="true" placeholder="question body here"></textarea>
                        <textarea class="form-control form-control-sm" style="border-radius: 8px;border-style: none;height: 120px;transform: skew(0deg);" spellcheck="true" placeholder="Examples"></textarea></form>
                </div>
                <div class="col-md-6" style="border-width: 0px;">
                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <div class="row">
                                        <div class="col">
                                            <div id="functionTestTabsContainer">
                                                <span id="tabsContainer">
                                                <!-- <div id="ftest1" class="functionTestTab left">convertFtoC</div> -->
                                                <!-- <div id="ftest2" class="functionTestTab">convertFtoC</div>
                                                <div id="ftest3" class="functionTestTab">convertFtoC</div>
                                                <div id="ftest4" class="functionTestTab">convertFtoC</div> -->
                                                </span>
                                                <input id="functNameInput" class="form-control form-control-sm right left" type="text" style="border-style: none;" placeholder="function name">
                                                <div id="addFntest" onclick="createNewFNTest(function(){
                                                    return document.getElementById(`functNameInput`).value;
                                                }())">&nbsp+</div>
                                            </div>
                                            <div id="functionListPanel">
                                                <div id="codeEditor" class="form-control form-control-sm" style="position: relative; padding:0px; border-radius: 8px;border-style: none; height: 393px;" spellcheck="true"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="row">
                                <div class="col-md-6">
                                    <div class="list-group" id="list-tab" role="tablist">
                                        <a class="list-group-item list-group-item-action " id="list-home-list" data-toggle="list" href="#list-home" role="tab" aria-controls="home">Home</a>
                                        <a class="list-group-item list-group-item-action" id="list-profile-list" data-toggle="list" href="#list-profile" role="tab" aria-controls="profile">Profile</a>
                                        <a class="list-group-item list-group-item-action" id="list-messages-list" data-toggle="list" href="#list-messages" role="tab" aria-controls="messages">Messages</a>
                                        <a class="list-group-item list-group-item-action" id="list-settings-list" data-toggle="list" href="#list-settings" role="tab" aria-controls="settings">Settings</a>
                                      </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="tab-content" id="nav-tabContent">
                                        <div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">a</div>
                                        <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">b</div>
                                        <div class="tab-pane fade" id="list-messages" role="tabpanel" aria-labelledby="list-messages-list">c</div>
                                        <div class="tab-pane fade" id="list-settings" role="tabpanel" aria-labelledby="list-settings-list">c</div>
                                      </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="row">
                        <!-- <div id="functionTestTabsContainer">
                            <span id="tabsContainer">
                            <div id="ftest1" class="functionTestTab left">convertFtoC</div>
                            <div id="ftest2" class="functionTestTab">convertFtoC</div>
                            <div id="ftest3" class="functionTestTab">convertFtoC</div>
                            <div id="ftest4" class="functionTestTab">convertFtoC</div>
                            </span>
                            <input id="functNameInput" class="form-control form-control-sm right" type="text" style="border-style: none;" placeholder="function name">
                            <div id="addFntest" onclick="createNewFNTest(function(){
                                return document.getElementById(`functNameInput`).value;
                            }())">&nbsp+</div>
                        </div>
                        <div id="functionListPanel">
                            <div id="codeEditor" class="form-control form-control-sm" style="padding:0px; border-radius: 8px;border-style: none;height: 300px;" spellcheck="true"></div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <h3 style="opacity: 0.40;">Preview</h3>
            <div style="box-shadow: 0px 0px 16px 0px rgba(33,37,41,0.14);padding-right: 10px;padding-left: 10px;border-radius: 10px;">
                <h1>Heading</h1>
            </div>
        </div>
    </div> 

</body>
<!-- react scripts -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

<script type = "text/babel" src="assets/js/questionTemplates.jsx"></script>
<script>
var editor = null;
var functionMaps = new Map();
var activeFunctiontestTab = "fntest-0";
window.onload = function() {
    editor = CodeMirror(document.querySelector('#codeEditor'), {
    lineNumbers: true,
    firstLineNumber: 0,
    tabSize: 2,
    value: '//your function here',
    theme: "myCodeEditorTheme",
    continueComments: "Enter",
    mode: 'javascript',
    lineWrapping: true,
    matchBrackets: true,
    autoCloseBrackets: true,
    extraKeys: {"Ctrl-Q": "toggleComment"},
    });
    document.getElementById("codeEditor").addEventListener("keyup", function(e){
        functionMaps.set(activeFunctiontestTab, editor.getValue());
    });
}
// $('#list-tab a').on('click', function (e) {
//     e.preventDefault()
// $(this).tab('show')
// console.log(this);
// });
// console.log("jquery select", $('#myList a'));
function createNewFNTest(name){
    console.log(name);
    var element = createNewFNtab(name);
}
function setActiveFunctionsTab(activeTab){
    var elements = document.getElementsByClassName("functionTestTab");
    for(element of elements){
        element.classList.remove("activeTab");
    }
    document.getElementById(activeTab).classList.add("activeTab");
}
</script>
<script>
class Test {
    title;
    testQuestionSet;
    currentQuestion;
    constructor(title) {
        this.testQuestionSet = new Array();
        this.currentQuestion = 0;
        this.title = title;
    }
    //add question setters and getters
    addQuestion(newQuestion) {
        this.testQuestionSet.push(newQuestion);
    }
    nextQuestion() {
        if (this.currentQuestion >= this.testQuestionSet.length - 1) {
            return;
        }
        this.currentQuestion++;
    }
    returnCurrentQuestion() {
        return this.testQuestionSet[this.currentQuestion];
    }
    returnQuestionSet() {
        return this.testQuestionSet;
    }
}
class Question {
    title;
    text; //Question - a string
    example;
    logs;//array of console.logs to be detected 
    vars; //variables to be detected
    functs; //functions to be made, along with tests.
    //we got three types of questions so far, asking for console.logs; asking to create variables with specific values, function name and expected inputs/outputs
    constructor(title) {
        this.text = "";
        this.logs = [];
        this.vars = [];
        this.functs = [];
        this.title = title;
        this.example = "";
    }
    returnText() {
        return this.text;
    }
    returnConsoleTests() {
        return this.logs;
    }
    returnVariableTests() {
        return this.vars;
    }
    returnFunctionTests() {
        return this.functs;
    }
    addConsoleRequirements(testCase) { //could be a number or string. 
        this.logs.push(testCase);
    }
    addVariableRequirements(newVariableTest) {
        this.vars.push({ name: newVariableTest.name, val: newVariableTest.val, scopeName:  newVariableTest.scopeName});
    }
    addFunctionRequirements(newFunctionTest) { //string, array[{input = "", output = ""}, ..]
        this.functs.push({ name: newFunctionTest.name, tests: newFunctionTest.test, functionDefinition:newFunctionTest.functionDefinition });
    }
    setExample(newExample){
        this.example = newExample;
    }
    setBody(text){
        this.text = text;
    }

}
class variableTest {
    type; //eg var, let, or... am i missing anything? *currently not used.
    name; //name
    val; //value. strings allowed
    scopeName;
    constructor(name, value, scopeName) {
        this.name = name;
        this.val = value;
        this.scopeName = scopeName;
    }
}
class functionTest {
    name; //function name without the parenthesis
    tests; //
    functionDefinition;
    constructor(name) {
        this.name = name;
        this.tests = new Array();
        this.functionDefinition = "";
    }
    addTest(testInput, expectedOutput) { //testInput = "<string>" ie: "3", 
        this.tests.push({ input: testInput, output: expectedOutput });
    }
    setDefinition(string){
        this.functionDefinition = string;
    }
}


</script>
<script>

function populateATesterTest() {
    var newTest = new Test("Welcome to Programming");

    var newQuestion = new Question(``);
    newQuestion.setExample(`x = 6 in scope of abc `);
    var newVariableTest = new variableTest("x", 6, "abc");
    newQuestion.addVariableRequirements(newVariableTest);
    newTest.addQuestion(newQuestion);
    return newTest;
}
var newTest = {
    title: "test",
    test: "test",
    currentQuestion: 0,
    testQuestionSet: [
        {
            title: "Test",
            text: `<input type="text" id="expression" class="label" value="-(10+pi^log(2^3))*((e*-2)+9-3^3)/2">
<!-- <input type="text" id="expression" class="label" value="1 + log(2)"> -->
<button onclick="calculate()">Calculate</button>
<div id="postfixed"></div>
<div id="results"></div>`,
            startingCode: `  const deliminters = new RegExp(/([*|/|+|\\-|^|)|(])/);
  const numbers = new RegExp(/([0-9])/);
  const invalidToken = new RegExp(/([a-zA-Z]+)/);
  const brackets = [new RegExp(/[(]/), new RegExp(/[)]/)];
  const isString = new RegExp(/"/);

  class Node {
    leftNode;
    rightNode;
    value;
    type;
    constructor(value) {
      this.value = value;
      if (this.value === "pi") {
        this.type = "num";
      }
      if (this.value === "e") {
        this.type = "num";
      }
      if (numbers.test(this.value)) {
        this.value = Number(this.value);
        this.type = "num";
      } else
        if (deliminters.test(this.value)) {
          this.type = "operator";
          if (brackets[0].test(this.value)) {
            this.type = "openBraces";
          }
          if (brackets[1].test(this.value)) {
            this.type = "closingBraces";
          }
        }
      if (this.value === "log") {
        this.type = "operator";
      }
    }
    eval() {
      if (this.type === "num") {
        if (this.value === "pi") {
          return 22 / 7;
        }
        if (this.value === "e") {
          return 2.7182818284;
        }
        return this.value;
      } else if (this.type === "operator") {
        switch (this.value) {
          case "^": return Math.pow(this.leftNode.eval(), this.rightNode.eval());
          case "*": return this.leftNode.eval() * this.rightNode.eval();
          case "/": return this.leftNode.eval() / this.rightNode.eval();
          case "+": return this.leftNode.eval() + this.rightNode.eval();
          case "-": return this.leftNode.eval() - this.rightNode.eval();
          case "log": return Math.log10(this.rightNode.eval());
        }
      }
    }
  }

  function calculate() {
    var newExpression = document.getElementById("expression").value;
    var newTokens = tokenizer(newExpression); //converts expression from postfix to infix
    // console.log(newTokens);
    document.getElementById("postfixed").innerHTML = "<p>" + newTokens.join(" ") + "</p>";
    var newTokenTree = parseTokens(newTokens);
    // console.log(newTokenTree);
    document.getElementById("results").innerHTML = "<p>Results = " + newTokenTree.eval() + "</p>";

  }
  function parseTokens(expressionArray) {
    var newNumberStack = new Stack();
    for (var index = 0; index < expressionArray.length; index++) {
      var token = expressionArray[index];
      // console.log("token = ", token);
      var newNode = new Node(token);
      // console.log(newNode);
      if (newNode.type === "num") {
        newNumberStack.push(newNode);
      } else if (newNode.type === "operator") {
        if (newNode.value === "log") {
          newNode.rightNode = newNumberStack.pop();
          newNumberStack.push(newNode);
          continue;
        }
        newNode.rightNode = newNumberStack.pop();
        newNode.leftNode = newNumberStack.pop();
        newNumberStack.push(newNode);
      }
      // console.log(newNode);
    }
    // console.log(newNode); 
    return newNode;
  }
  function tokenizer(expression) {
    expression = expression.split(deliminters);
    expression = removeEmptyIndices(expression);
    expression = recombineNegatives(expression);
    expression = removeEmptyIndices(expression);
    expression = trimStringInArray(expression);
    var postFixed = new Array();
    var operationStack = new Stack();
    for (var index = 0; index < expression.length; index++) {
      var token = expression[index];
      if (numbers.test(token) || token === "pi" || token === "e") { //if number
        postFixed.push(token)
      } else if (brackets[0].test(token)) { //if open brackets
        operationStack.push(token);
      }
      else if (brackets[1].test(token)) { //if closing brackers
        while (operationStack.peek() !== "(") {
          postFixed.push(operationStack.pop());
        }
        operationStack.pop();
      }
      else {
        // console.log(eval(getPrecedence(operationStack.peek()) >= getPrecedence(token)));
        while (getPrecedence(operationStack.peek()) >= getPrecedence(token)) {
          postFixed.push(operationStack.pop());
        }
        operationStack.push(token);
      }
    }
    while (typeof (operationStack.peek()) !== "undefined") {
      postFixed.push(operationStack.pop());
    }
    // console.log(postFixed);
    return postFixed;
  }
  function recombineNegatives(array) {
    var newArray = new Array();
    for (var index = 0; index < array.length; index++) {
      if (array[index] === "-" && (deliminters.test(array[index - 1]) || index === 0) && !brackets[1].test(array[index - 1])) {
        newArray.push("-1");
        newArray.push("*");
      } else {
        newArray.push(array[index]);
      }
    }
    return newArray;
  }
  function getPrecedence(value) {
    switch (value) { //PEMDAS
      case "log": return 5;
      case "^": return 4;
      case "/": return 3;
      case "*": return 3;
      case "+": return 2;
      case "-": return 2;
      case "(": return 0;
    }
  }
  function sliceArray(array, start, end) { //returns a stack of statements as an array
    var newArray = new Array();
    for (index = start; index <= end; index++) {
      newArray.push(array[index]);
    }
    return newArray;
  }
  function findMatching(array, start, token) { //token = "(" pr "{"
    //raw string -> breakIntoComponents() first. start is the index of the array where a function declartion is detected.
    var token_2 = null;
    if (token === "{") {
      token_2 = "}";
    } else if (token === "(") {
      token = (/([(])/);
      token_2 = (/([)])/);
    }
    var count = 0;
    var endLine = -1;
    for (index = start; index < array.length; index++) {
      if (array[index].search(token) > -1) {
        count = count + 1;
      }
      if (array[index].search(token_2) > -1) {
        count = count - 1;
      }
      if (count === 0 && array[index].search(token_2) > -1) {
        endLine = index;
        break;
      }
      // console.log(count);
    }
    return endLine;
  }
  function removeEmptyIndices(array) {
    //clean array if nothing is detected on indexes
    var newArray = new Array();
    for (index = 0; index < array.length; index++) {
      if (!(array[index].trim().length === 0)) {
        newArray.push(array[index]);
      }
    }
    return newArray;
  }
  function trimStringInArray(array) {
    for (index = 0; index < array.length; index++) {
      array[index] = array[index].trim();
    }
    return array;
  }

window.calculate = calculate;`
        }
    ]
}

var newTest1 = {
    title: "Welcome to Javascript",
    text : "We will be learning about variables and different types of keywords you can use to declare a variable. We will be learning learning about function declaration",
      currentQuestion: 0,
      testQuestionSet: [
      {
            title: "Variable Declarations",
            text: `To declare a variable in javascript, you need to use the keyword <i>var</i>, <i>let</i> or <i>const</i>. We will discuss the differences of these keywords later on.
After the keyword, you can pick out a variable name. `,
            example: `var x = 10
//"var" : is the keyword used to declare a variable type. In javascript, you could also use the keyword "let" and "const"
//"x" : is the name we want to set this variable to
//10 : is the value we initially set for variable x.
//notes: We could also declare a variable without setting it to anything. It will just default to undefined`,
            startingCode: `//lets go ahead and try that ourselves. lets declare a variable with a keyword of var and a name of "myFirstVariableName", without the quotations.
//then set it equals to the value of "Hello World"
//please inclure the quotations with the value as shown above.
//your code after this line`,
            functs: [],
            logs: [],
            vars: [{name: "myFirstVariableName", type: "var", scopeName: "default", val: "Hello World"}]
        },
        {
            title: "Lets print something out to the console",
            text:`The console is <i><b>the</b></i> tool to use when developing actual javascript programs. It is the main tool you will use when doing stuff like debugging your program.
It can be accessed through a right click on your browser, then clicking the "Inspect" button. But theres also a simple mock up of the console here on the website. It is the panel to your right at the bottom.

Alright, what you'll mainly be using the console for is debugging, and a big part of that comes from just printing the variables that's going on in your program using the function <i><b>console.log()</b></i>. <i>It's actually an object with a method so I'm lying to you right now but we'll talk about that later</i>
 But by printing out variables and actually seeing what is happening, this way, you understand what it is you are trying to do versus you are actually doing..

In the previous question, we set a new variable <i>myFirstVariableName</i> using the keyword "var". Then we set it equals to "Hello World", which is a string by the way. Lets try to display that.` ,
            example : `var abc = 10 //we can also set variables to numbers and numerous other things
console.log(abc)
//what you'll expect to see in the console is 10`,
            startingCode: `//lets use the console to print out the variable we just made
var myFirstVariableName = "Hello World"`,
            logs: [{val: "Hello World", scopeName: "default"}],
            vars: [{name: "myFirstVariableName", type: "var", scopeName: "default", val: "Hello World"}]
        },
        {
            title : "Functions",
            text : `Much like variables, functions are one of the main building blocks for any programs, but the keyword you need to use to create a function is "function" A function is basically a module inside a piece of code that does one task, and it only does it when its called to do so. 

We want to use functions in our programming because it reduces repetition. If there's something you want to do in your program more than once, you could suppositly keep writing out the code to do that thing multiple times, or you could simply turn it into a function and call it using it's name each time you want to do that thing.`,
            example : `//here is a function that simply create a variable x, sets it to hello world, then prints x to the console.
function exampleFunctionName(){ 
    var x = "Hello World";
    console.log(x);               
}
//to use this function, you must call it using it's name
exampleFunctionName();`,
            startingCode : `//Create a function named myFirstFunction
//inside the function, create a new variable named x using the keyword "var", and then assign it the value of "Hello World".
//then call the function`,
            vars: [{name : "x", val : "Hello World", type: "var", scopeName : "myFirstFunction"}],
            stringTests : ["function myFirstFunction()", "myFirstFunction()"]
        },
        {
            title: "Function Returns",
            text: "Functions could return values. This is useful because often times, you might want to know the results. For example, if you had a function that adds two numbers, it would be helpful to be able to pass the sum back.",
            example: `//declaring a new function named "addTwoNums"
function addTwoNums(){
var num1 = 10;
var num2 = 15;
var sum = num1 + num2;
//you can use the keyword return to return a value. Additionally, what you could also do here is 
//instead of doing "return sum", you could do return (num1 + num2)
return sum;                
}

//the return of the function addTwoNums gets assigned to var sum here.
var sum = addTwoNums();
//expected output: 15
console.log(sum); 
`,
            startingCode: `//Modify the code below to catch the return for function MultiplyTwoNumbers into variable "product"
function MultiplyTwoNumbers(){
    var num1 = 5;
    console.log("num1 is : ", num1);
    var num2 = 6;
    console.log("num2 is : ", num2);
    var product = num1 * num2;  //this operation should result in 30
    //write a line here to return the variable "product" above
}

//assign product to the function "MultiplyTwoNumbers"
var product;
//expect to see 30 printed out
console.log(product);
`,
        vars : [{name: "product", scopeName: "default", val: 30, type: "var"}],
        stringTests: ['return product', 'var product = MultiplyTwoNumbers()'],
        logs: [{val: "30", scopeName: "default"}],
        }

      ],
};

console.log(newTest);
var newPost = {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(newTest)
}
fetch('http://137.184.237.82:3000/postLab', newPost).then((response) => response.json()).then((data) => {
    console.log(data.URL);
});
</script>
</html>